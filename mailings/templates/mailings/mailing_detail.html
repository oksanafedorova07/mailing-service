{% extends 'base.html' %}
{% block title %}–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—Å—ã–ª–∫–∏{% endblock %}

{% block content %}
<h2 class="mb-3">–†–∞—Å—Å—ã–ª–∫–∞ ‚Ññ{{ object.pk }}</h2>
<p><strong>–°—Ç–∞—Ç—É—Å:</strong> {{ object.status }}</p>
<p><strong>–ù–∞—á–∞–ª–æ:</strong> {{ object.start_time }}</p>
<p><strong>–û–∫–æ–Ω—á–∞–Ω–∏–µ:</strong> {{ object.end_time }}</p>
<p><strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> {{ object.message.subject }}</p>
<p><strong>–ö–ª–∏–µ–Ω—Ç—ã:</strong></p>
<ul>
    {% for client in object.clients.all %}
    <li>{{ client.full_name }} &lt;{{ client.email }}&gt;</li>
    {% endfor %}
</ul>

<div class="mt-4 d-flex flex-wrap gap-2">
    {% if user == object.owner %}
        <a href="{% url 'mailings:mailing_update' object.pk %}" class="btn btn-warning">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <a href="{% url 'mailings:mailing_delete' object.pk %}" class="btn btn-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
        <a href="{% url 'mailings:mailing_send' object.pk %}" class="btn btn-primary">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</a>
    {% endif %}
    <a href="{% url 'mailings:mailing_list' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
</div>

<hr class="my-5">

<h3 class="mb-3">üìä –ü–æ–ø—ã—Ç–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏</h3>

{% if object.attempts.all %}
<table class="table table-striped table-bordered rounded shadow-sm">
    <thead class="table-light">
        <tr>
            <th>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞</th>
        </tr>
    </thead>
    <tbody>
        {% for attempt in object.attempts.all %}
        <tr>
            <td>{{ attempt.time }}</td>
            <td>
                {% if attempt.status == '–£—Å–ø–µ—à–Ω–æ' %}
                    <span class="badge bg-success">{{ attempt.status }}</span>
                {% else %}
                    <span class="badge bg-danger">{{ attempt.status }}</span>
                {% endif %}
            </td>
            <td>{{ attempt.server_response }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info">–ü–æ–∫–∞ –Ω–µ –±—ã–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏.</div>
{% endif %}
{% endblock %}